# ğŸ›ï¸ é‹åº—é›»å•†ç³»çµ±

å°ˆæ¥­çš„åœ¨ç·šé‹åº—é›»å•†å¹³å° - Next.js 14 + GraphQL + PostgreSQL

**ç‰ˆæœ¬**: 1.0.2 | **ç‹€æ…‹**: ç”Ÿç”¢å°±ç·’ âœ… | **æœ€å¾Œæ›´æ–°**: 2025-10-29

---

## ğŸ“‘ å¿«é€Ÿå°èˆª

| æ ¸å¿ƒ | é–‹ç™¼ | é€²éš |
|------|------|------|
| [å¿«é€Ÿé–‹å§‹](#-å¿«é€Ÿé–‹å§‹) | [å°ˆæ¡ˆæ¶æ§‹](#-å°ˆæ¡ˆæ¶æ§‹) | [æ•ˆèƒ½å„ªåŒ–](#-æ•ˆèƒ½å„ªåŒ–) |
| [æ¸¬è©¦å¸³è™Ÿ](#-æ¸¬è©¦å¸³è™Ÿ) | [API æ–‡æª”](#-api-æ–‡æª”) | [éƒ¨ç½²æ¸…å–®](#-éƒ¨ç½²) |
| [æ ¸å¿ƒåŠŸèƒ½](#-æ ¸å¿ƒåŠŸèƒ½) | [æ•…éšœæ’é™¤](#-æ•…éšœæ’é™¤) | [æ›´æ–°æ—¥èªŒ](#-æ›´æ–°æ—¥èªŒ) |

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

| ğŸ›’ é›»å•†æ ¸å¿ƒ | ğŸ‘Ÿ é‹åº—å°ˆå±¬ | ğŸ“¢ ç‡ŸéŠ·å®¢æœ |
|------------|------------|------------|
| â€¢ LINE Login + OTP èªè­‰<br>â€¢ **å‹•æ…‹æœƒå“¡ç­‰ç´šç³»çµ±** â­<br>â€¢ è³¼ç‰©é‡‘ & å„ªæƒ åˆ¸<br>â€¢ å®Œæ•´é€€è²¨æµç¨‹<br>â€¢ è¨‚å–®è¿½è¹¤ç®¡ç† | â€¢ å¤šåœ‹å°ºç¢¼å°ç…§ (EUR/US/UK/CM)<br>â€¢ é¡è‰²è®Šé«”ç³»çµ±<br>â€¢ å°ºç¢¼ç¨ç«‹åº«å­˜<br>â€¢ å°ºç¢¼åˆé©åº¦åé¥‹<br>â€¢ é‹é¡å°ˆå±¬å±¬æ€§ | â€¢ æ™ºèƒ½å…¬å‘Šæ¨æ’­ âœ¨<br>â€¢ é‚€è«‹ç¢¼çå‹µç³»çµ±<br>â€¢ ç¤¾ç¾¤åˆ†äº« & é€£çµ<br>â€¢ å®¢æœèŠå¤©ç³»çµ±<br>â€¢ è©•è«– & è©•åˆ† |

**ğŸŒŸ ç‰¹è‰²äº®é»**
- **å®Œå…¨å‹•æ…‹æœƒå“¡ç­‰ç´š** - å¾Œå°å¯è‡ªç”±æ–°å¢/åˆªé™¤ç­‰ç´šã€å‹•æ…‹èª¿æ•´é–€æª»å’Œæ¬Šç›Šã€ä¸€éµé‡ç®—æ‰€æœ‰ç”¨æˆ¶
- **æ™ºèƒ½å…¬å‘Šç³»çµ±** - å½ˆçª—å¼é¡¯ç¤ºã€æ”¯æ´æ›´æ–°æª¢æ¸¬ã€å¾Œå°ä¿®æ”¹å¾Œè‡ªå‹•é‡æ–°é¡¯ç¤ºçµ¦ç”¨æˆ¶
- **é›™è»Œèªè­‰ç³»çµ±** - æ¶ˆè²»è€…ä½¿ç”¨ LINE Loginã€ç®¡ç†å“¡ä½¿ç”¨å¿«é€Ÿç™»å…¥ç¢¼ï¼ˆ`admin0900`ï¼‰

---

## ğŸ› ï¸ æŠ€è¡“æ£§

| å‰ç«¯ | å¾Œç«¯ | è³‡æ–™åº« |
|------|------|--------|
| Next.js 14 (App Router)<br>TypeScript<br>Tailwind CSS v4<br>Apollo Client<br>React Hook Form + Zod | Next.js API Routes<br>GraphQL Yoga<br>JWT + bcryptjs | PostgreSQL<br>Prisma ORM<br>Redis (å¿«å–)

---

## ğŸ“¦ å¿«é€Ÿé–‹å§‹

### 1. å®‰è£ä¾è³´ï¼ˆå¿…é ˆä½¿ç”¨ pnpmï¼‰

```bash
pnpm install
```

### 2. ç’°å¢ƒè®Šæ•¸è¨­å®š

å‰µå»º `.env` æ–‡ä»¶ï¼š

```env
# è³‡æ–™åº«
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/shoe_store"

# Redisï¼ˆé¸ç”¨ï¼Œç”¨æ–¼å¿«å–å’Œé€Ÿç‡é™åˆ¶ï¼‰
REDIS_URL="redis://localhost:6379"

# JWT èªè­‰
JWT_SECRET="your-secret-key-here-change-in-production"
JWT_EXPIRES_IN="7d"

# Next.js
NEXT_PUBLIC_API_URL="http://localhost:3000"
NEXT_PUBLIC_GRAPHQL_URL="http://localhost:3000/api/graphql"
NEXT_PUBLIC_SITE_URL="http://localhost:3000"

# ============================================
# LINE Login é…ç½®ï¼ˆå¾ LINE Developers Console å–å¾—ï¼‰
# ============================================

# LINE Login (OAuth) - åœ¨ Basic settings é ç±¤
LINE_CHANNEL_ID="ä½ çš„_Channel_ID"           # ä¾‹å¦‚: 1234567890
LINE_CHANNEL_SECRET="ä½ çš„_Channel_Secret"   # ä¾‹å¦‚: abc123def456...
LINE_CALLBACK_URL="http://localhost:3000/auth/line-verify"

# LINE Messaging API - åœ¨ Messaging API é ç±¤
LINE_MESSAGING_ACCESS_TOKEN="ä½ çš„_Channel_Access_Token"  # é•·å­—ä¸²,éœ€å…ˆé»æ“Š "Issue" ç”Ÿæˆ
LINE_OFFICIAL_ACCOUNT_ID="ä½ çš„_Basic_ID"                 # ä¾‹å¦‚: @abc1234
```

### 2.1 LINE Login è¨­å®š

<details>
<summary><b>ğŸ“˜ è©³ç´°è¨­å®šæ­¥é©Ÿï¼ˆé»æ“Šå±•é–‹ï¼‰</b></summary>

1. **å»ºç«‹ Provider**: å‰å¾€ [LINE Developers Console](https://developers.line.biz/console/)
2. **å‰µå»ºå…©å€‹ Channels**:
   - **LINE Login** - å–å¾— Channel ID å’Œ Channel Secret
   - **Messaging API** - å–å¾— Access Token å’Œ Basic ID
3. **è¨­å®š Callback URL**: `http://localhost:3000/auth/line-verify`
4. **å•Ÿç”¨ Messaging API**: é–‹å•Ÿ Webhooksã€é—œé–‰è‡ªå‹•å›è¦†
5. **æ¸¬è©¦**: è¨ªå• `/auth/login` æ¸¬è©¦ç™»å…¥æµç¨‹

è©³ç´°è¨­å®šæ•™å­¸è«‹åƒè€ƒ [LINE Developers å®˜æ–¹æ–‡æª”](https://developers.line.biz/zh-hant/docs/)

</details>

### 3. è³‡æ–™åº«è¨­å®š

```bash
# å•Ÿå‹• PostgreSQL
brew services start postgresql

# å‰µå»ºè³‡æ–™åº«
createdb shoe_store

# ç”Ÿæˆ Prisma Client
pnpm db:generate

# åŸ·è¡Œè³‡æ–™åº«é·ç§»ï¼ˆé–‹ç™¼ç’°å¢ƒï¼‰
pnpm db:migrate

# åŸ·è¡Œç¨®å­è³‡æ–™ï¼ˆå¯é¸ï¼‰
pnpm db:seed

# å•Ÿå‹• Redisï¼ˆé¸ç”¨ï¼‰
brew services start redis
```

### 4. å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨

```bash
pnpm dev
```

è¨ªå• `http://localhost:3000`

**GraphQL API**: `http://localhost:3000/api/graphql`

### 5. å¸¸ç”¨æŒ‡ä»¤

```bash
# é–‹ç™¼ç’°å¢ƒ
pnpm dev                    # å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
pnpm db:generate            # ç”Ÿæˆ Prisma Client
pnpm db:migrate             # è³‡æ–™åº«é·ç§»ï¼ˆé–‹ç™¼ç’°å¢ƒï¼‰
pnpm db:studio              # æŸ¥çœ‹è³‡æ–™åº«ï¼ˆPrisma Studioï¼‰

# æ¸¬è©¦èˆ‡æ§‹å»º
pnpm test                   # åŸ·è¡Œæ¸¬è©¦
pnpm test:watch             # æ¸¬è©¦ç›£è¦–æ¨¡å¼
pnpm build                  # å»ºæ§‹ç”Ÿç”¢ç‰ˆæœ¬
pnpm start                  # å•Ÿå‹•ç”Ÿç”¢ä¼ºæœå™¨
pnpm lint                   # ç¨‹å¼ç¢¼æª¢æŸ¥

# è³‡æ–™åº«ç®¡ç†
pnpm prisma migrate status  # æŸ¥çœ‹å¾…è™•ç†çš„é·ç§»
pnpm db:deploy              # éƒ¨ç½²é·ç§»ï¼ˆç”Ÿç”¢ç’°å¢ƒï¼‰
pnpm prisma migrate reset   # é‡ç½®è³‡æ–™åº«ï¼ˆå±éšªï¼æœƒæ¸…ç©ºæ‰€æœ‰è³‡æ–™ï¼‰
```

### 6. ä¸»è¦é é¢è·¯ç”±

| å‰å° | å¾Œå° (éœ€ ADMIN) |
|------|-----------------|
| `/` - é¦–é <br>`/products` - ç”¢å“åˆ—è¡¨<br>`/products/[slug]` - ç”¢å“è©³æƒ…<br>`/cart` - è³¼ç‰©è»Š<br>`/checkout` - çµå¸³<br>`/orders` - è¨‚å–®è¨˜éŒ„<br>`/auth/login` - LINE ç™»å…¥<br>`/account/referral` - é‚€è«‹ç¢¼<br>`/account/returns` - é€€è²¨ç”³è«‹ | `/admin/login` - ç®¡ç†å“¡ç™»å…¥<br>`/admin/products` - ç”¢å“ç®¡ç†<br>`/admin/brands` - å“ç‰Œç®¡ç†<br>`/admin/orders` - è¨‚å–®ç®¡ç†<br>`/admin/users` - ç”¨æˆ¶ç®¡ç†<br>`/admin/credits` - è³¼ç‰©é‡‘<br>`/admin/announcements` - å…¬å‘Š<br>`/admin/returns` - é€€è²¨å¯©æ ¸ |

---

## ğŸ“ å°ˆæ¡ˆæ¶æ§‹

### æŠ€è¡“æ¶æ§‹
é€™æ˜¯ä¸€å€‹ **Next.js 14 å…¨ç«¯å–®é«”æ¶æ§‹**ï¼ˆApp Routerï¼‰ï¼Œå‰ç«¯èˆ‡å¾Œç«¯æ•´åˆåœ¨åŒä¸€å€‹å°ˆæ¡ˆä¸­ï¼š
- **å‰ç«¯**: React çµ„ä»¶ + Tailwind CSS
- **å¾Œç«¯**: Next.js API Routes + GraphQL Yoga
- **è³‡æ–™åº«**: PostgreSQL + Prisma ORM
- **å¿«å–**: Redisï¼ˆé¸ç”¨ï¼‰

### å°ˆæ¡ˆçµæ§‹

```
shoe/
â”œâ”€â”€ app/                    # Next.js App Routerï¼ˆå‰ç«¯ + APIï¼‰
â”‚   â”œâ”€â”€ api/graphql/        # GraphQL API ç«¯é»ï¼ˆå¾Œç«¯æ ¸å¿ƒï¼‰
â”‚   â”œâ”€â”€ admin/              # å¾Œå°ç®¡ç†ï¼ˆéœ€ ADMIN æ¬Šé™ï¼‰
â”‚   â”‚   â”œâ”€â”€ login/          # ç®¡ç†å“¡ç™»å…¥é 
â”‚   â”‚   â”œâ”€â”€ products/       # ç”¢å“ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ brands/         # å“ç‰Œç®¡ç†
â”‚   â”‚   â”œâ”€â”€ categories/     # åˆ†é¡ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ orders/         # è¨‚å–®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ users/          # ç”¨æˆ¶ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ returns/        # é€€è²¨ç®¡ç†
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ account/            # ç”¨æˆ¶å¸³æˆ¶é é¢
â”‚   â”œâ”€â”€ auth/               # èªè­‰é é¢ï¼ˆLINE Loginï¼‰
â”‚   â”œâ”€â”€ products/           # ç”¢å“é é¢
â”‚   â”œâ”€â”€ cart/               # è³¼ç‰©è»Š
â”‚   â””â”€â”€ checkout/           # çµå¸³
â”œâ”€â”€ components/             # React çµ„ä»¶
â”‚   â”œâ”€â”€ admin/              # å¾Œå°çµ„ä»¶
â”‚   â”œâ”€â”€ product/            # ç”¢å“ç›¸é—œï¼ˆå°ºç¢¼é¸æ“‡å™¨ã€é¡è‰²é¸æ“‡å™¨ï¼‰
â”‚   â”œâ”€â”€ checkout/           # çµå¸³ç›¸é—œï¼ˆè³¼ç‰©é‡‘é¸æ“‡å™¨ï¼‰
â”‚   â””â”€â”€ common/             # é€šç”¨çµ„ä»¶ï¼ˆå…¬å‘Šæ©«å¹…ã€é‚€è«‹ç¢¼è¿½è¹¤ï¼‰
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ graphql/            # GraphQL é…ç½®
â”‚   â”‚   â”œâ”€â”€ resolvers/      # æ¥­å‹™é‚è¼¯ï¼ˆauth, product, cart, order...ï¼‰
â”‚   â”‚   â”œâ”€â”€ schema.ts       # Schema å®šç¾©
â”‚   â”‚   â””â”€â”€ queries.ts      # å‰ç«¯æŸ¥è©¢å®šç¾©
â”‚   â”œâ”€â”€ lib/                # æ ¸å¿ƒå·¥å…·
â”‚   â”‚   â”œâ”€â”€ prisma.ts       # è³‡æ–™åº« ORM
â”‚   â”‚   â”œâ”€â”€ auth.ts         # JWT èªè­‰
â”‚   â”‚   â”œâ”€â”€ line.ts         # LINE OAuth å’Œ Messaging API
â”‚   â”‚   â”œâ”€â”€ otp.ts          # OTP ç”Ÿæˆã€ç™¼é€ã€é©—è­‰
â”‚   â”‚   â”œâ”€â”€ redis.ts        # å¿«å–é€£æ¥
â”‚   â”‚   â”œâ”€â”€ cache.ts        # å¿«å–ç­–ç•¥
â”‚   â”‚   â””â”€â”€ slugify.ts      # Slug è‡ªå‹•ç”Ÿæˆ
â”‚   â””â”€â”€ contexts/           # React Contextï¼ˆAuthContextï¼‰
â””â”€â”€ prisma/
    â””â”€â”€ schema.prisma       # è³‡æ–™åº« Schema
```

### è³‡æ–™æµå‘

```
ç”¨æˆ¶ç€è¦½å™¨ â†’ React çµ„ä»¶ â†’ Apollo Client â†’ GraphQL API
â†’ Resolvers â†’ Prisma ORM â†’ PostgreSQL
```

---

## ğŸ¨ æ ¸å¿ƒåŠŸèƒ½èªªæ˜

### 1. è³¼ç‰©é‡‘ç³»çµ±
**å¾Œå°**: `/admin/credits` | **å‰å°**: çµå¸³é é¢

**åŠŸèƒ½**ï¼š
- å¾Œå°ç™¼æ”¾è³¼ç‰©é‡‘ï¼ˆå–®ä¸€/æ‰¹é‡ï¼‰
- è¨­å®šä½¿ç”¨é™åˆ¶ï¼ˆæœ€ä½è¨‚å–®é‡‘é¡ã€å–®ç­†æœ€å¤§ä½¿ç”¨é¡ï¼‰
- è¨­å®šæœ‰æ•ˆæœŸé™
- è³¼ç‰©é‡‘ä¾†æºè¿½è¹¤ï¼ˆæ´»å‹•/é€€æ¬¾/ç®¡ç†å“¡ç™¼æ”¾/ç”Ÿæ—¥/è©•åƒ¹ï¼‰
- çµå¸³æ™‚é¸æ“‡ä½¿ç”¨è³¼ç‰©é‡‘
- è‡ªå‹•è¨ˆç®—æŠ˜æŠµé‡‘é¡

**è³‡æ–™è¡¨**: `user_credits`

**API**:
```graphql
# Query
myCredits
availableCreditAmount

# Mutation
grantCredit(input: GrantCreditInput!)
batchGrantCredit(input: BatchGrantCreditInput!)
```

---

### 2. é‚€è«‹ç¢¼ç³»çµ±
**è·¯å¾‘**: `/account/referral`

**åŠŸèƒ½**ï¼š
- è‡ªå‹•ç”Ÿæˆå°ˆå±¬é‚€è«‹ç¢¼
- è¤‡è£½é‚€è«‹é€£çµï¼ˆæ ¼å¼ï¼š`ç¶²ç«™ç¶²å€?ref=é‚€è«‹ç¢¼`ï¼‰
- URL åƒæ•¸è‡ªå‹•è¿½è¹¤ï¼ˆå„²å­˜ 30 å¤©ï¼‰
- å¥½å‹ä¸‹å–®å¾Œè‡ªå‹•ç™¼æ”¾è³¼ç‰©é‡‘çµ¦é‚€è«‹äºº
- æŸ¥çœ‹é‚€è«‹çµ±è¨ˆå’Œè¨˜éŒ„
- **é‚€è«‹ç¢¼æ°¸ä¸éæœŸï¼Œç„¡ä½¿ç”¨ä¸Šé™** â­

**æ³¨æ„**: è¢«é‚€è«‹äººä¸æœƒç²å¾—çå‹µï¼Œåªæœ‰é‚€è«‹äººç²å¾—è³¼ç‰©é‡‘

**è³‡æ–™è¡¨**: `referral_codes`, `referral_usages`

**é‹ä½œæ©Ÿåˆ¶**ï¼š
1. æ¯å€‹ç”¨æˆ¶è‡ªå‹•ç”Ÿæˆå°ˆå±¬é‚€è«‹ç¢¼
2. é‚€è«‹é€£çµæ ¼å¼ï¼š`ç¶²ç«™ç¶²å€?ref=é‚€è«‹ç¢¼`
3. è¢«é‚€è«‹äººé¦–æ¬¡ä¸‹å–®å®Œæˆå¾Œï¼Œè‡ªå‹•ç™¼æ”¾è³¼ç‰©é‡‘çµ¦é‚€è«‹äºº
4. æ¯å€‹ç”¨æˆ¶åªèƒ½ä½¿ç”¨ä¸€æ¬¡é‚€è«‹ç¢¼
5. ä¸èƒ½ä½¿ç”¨è‡ªå·±çš„é‚€è«‹ç¢¼

**API**:
```graphql
# Query
myReferralCode
referralStats

# Mutation
useReferralCode(code: String!, userId: String!)
```

---

### 3. å…¬å‘Šæ¨æ’­ç³»çµ±
**å¾Œå°**: `/admin/announcements` | **å‰å°**: é¦–é è‡ªå‹•å½ˆçª—é¡¯ç¤º

**åŠŸèƒ½**ï¼š
- 6 ç¨®å…¬å‘Šé¡å‹ï¼ˆè³‡è¨Š/æˆåŠŸ/è­¦å‘Š/éŒ¯èª¤/ä¿ƒéŠ·/ç¶­è­·ï¼‰
- å„ªå…ˆç´šè¨­å®šï¼ˆæ•¸å­—è¶Šå¤§è¶Šå„ªå…ˆé¡¯ç¤ºï¼‰
- æ™‚é–“ç¯„åœæ§åˆ¶ï¼ˆé–‹å§‹/çµæŸæ™‚é–“ï¼‰
- è¡Œå‹•æŒ‰éˆ•ï¼ˆå¯è¨­å®šé€£çµå’ŒæŒ‰éˆ•æ–‡å­—ï¼‰
- å‰å°è‡ªå‹•ä»¥å½ˆçª—å½¢å¼é¡¯ç¤ºæ‰€æœ‰æ´»èºå…¬å‘Š
- ç”¨æˆ¶å¯å–®ç¨é—œé–‰å€‹åˆ¥å…¬å‘Šæˆ–ä¸€éµã€Œå…¨éƒ¨ä¸å†é¡¯ç¤ºã€
- ä½¿ç”¨ localStorage æŒä¹…åŒ–è¨˜éŒ„å·²é—œé–‰çš„å…¬å‘Š

**UI ç‰¹è‰²**ï¼š
- å½ˆçª—å¼è¨­è¨ˆï¼Œä¸ä½”ç”¨ä¸»é é¢ç©ºé–“
- æ‰€æœ‰å…¬å‘Šåœ¨åŒä¸€å€‹å½ˆçª—ä¸­é¡¯ç¤ºï¼Œå¯æ»¾å‹•ç€è¦½
- æ¯å€‹å…¬å‘Šæœ‰ç¨ç«‹çš„é—œé–‰æŒ‰éˆ•ï¼ˆã€Œä¸å†é¡¯ç¤ºæ­¤å…¬å‘Šã€ï¼‰
- åº•éƒ¨æœ‰ã€Œç¨å¾Œå†çœ‹ã€å’Œã€Œå…¨éƒ¨ä¸å†é¡¯ç¤ºã€æŒ‰éˆ•
- é®ç½©å±¤é»æ“Šæˆ– ESC éµå¯è‡¨æ™‚é—œé–‰ï¼ˆä¸‹æ¬¡åˆ·æ–°ä»æœƒé¡¯ç¤ºï¼‰

**è³‡æ–™è¡¨**: `announcements`

**å‰ç«¯çµ„ä»¶**:
- `components/common/AnnouncementModal.tsx` - å½ˆçª—çµ„ä»¶
- `components/common/AnnouncementWrapper.tsx` - åŒ…è£çµ„ä»¶

---

### 4. å„ªæƒ åˆ¸ç³»çµ±
**å¾Œå°**: `/admin/coupons`

**4 ç¨®é¡å‹**ï¼š
- `PERCENTAGE` - ç™¾åˆ†æ¯”æŠ˜æ‰£
- `FIXED` - å›ºå®šé‡‘é¡
- `FREE_SHIPPING` - å…é‹è²»
- `BUY_X_GET_Y` - è²· X é€ Y

**åŠŸèƒ½**ï¼š
- ä½¿ç”¨é™åˆ¶è¨­å®š
- æœ‰æ•ˆæœŸé™æ§åˆ¶
- ä½¿ç”¨æ¬¡æ•¸ç®¡ç†

**è³‡æ–™è¡¨**: `coupons`, `user_coupons`

---

### 5. ç¤¾ç¾¤åˆ†äº«åŠŸèƒ½
**ä½ç½®**: æ‰€æœ‰ç”¢å“è©³æƒ…é 

**åŠŸèƒ½**ï¼š
- åˆ†äº«åˆ° Facebook
- åˆ†äº«åˆ° LINE
- Instagram åˆ†äº«ï¼ˆè¤‡è£½é€£çµï¼‰
- ä¸€éµè¤‡è£½ç”¢å“é€£çµ
- åˆ†äº«æˆåŠŸæç¤º

**å‰ç«¯çµ„ä»¶**: `components/product/SocialShareButtons.tsx`

---

### 6. å®¢æœèŠå¤©ç³»çµ±
**ç”¨æˆ¶**: `/account/support` | **ç®¡ç†å“¡**: `/admin/chats`

**åŠŸèƒ½**ï¼š
- ç”¨æˆ¶å‰µå»ºå°è©±
- ç™¼é€è¨Šæ¯
- ç®¡ç†å“¡å›è¦†
- å°è©±ç‹€æ…‹ç®¡ç†ï¼ˆé€²è¡Œä¸­/å·²é—œé–‰/å·²è§£æ±ºï¼‰
- è¨Šæ¯å·²è®€/æœªè®€è¿½è¹¤

**è³‡æ–™è¡¨**: `conversations`, `messages`

---

### 7. å®Œæ•´é€€è²¨ç³»çµ±
**ç”¨æˆ¶**: `/account/returns` | **ç®¡ç†å“¡**: `/admin/returns`

#### é€€è²¨æµç¨‹

1. **å®¢æˆ¶æäº¤ç”³è«‹** (REQUESTED)
   - é¸æ“‡å·²å®Œæˆçš„è¨‚å–®
   - é¸æ“‡è¦é€€è²¨çš„å•†å“
   - å¡«å¯«é€€è²¨åŸå› å’Œè©³ç´°èªªæ˜
   - ç³»çµ±è‡ªå‹•è¨ˆç®—é€€æ¬¾é‡‘é¡

2. **è³£å®¶å¯©æ ¸** (APPROVED/REJECTED)
   - ç®¡ç†å“¡åœ¨å¾Œå°æŸ¥çœ‹é€€è²¨ç”³è«‹
   - å¯©æ ¸ç”³è«‹ä¸¦æ±ºå®šæ‰¹å‡†æˆ–æ‹’çµ•
   - å¯æ·»åŠ ç®¡ç†å“¡å‚™è¨»èªªæ˜åŸå› 

3. **å®¢æˆ¶å¯„ä»¶**
   - å¯©æ ¸é€šéå¾Œï¼Œå®¢æˆ¶éœ€è‡ªè¡Œè‡³ 711 ä¾¿åˆ©åº—å¯„ä»¶
   - å¯„ä»¶å¾Œä¸Šå‚³ 711 å¯„ä»¶å–®è™Ÿ

4. **è³£å®¶ç¢ºèªæ”¶è²¨** (RECEIVED)
   - ç®¡ç†å“¡æ”¶åˆ°é€€è²¨å•†å“å¾Œç¢ºèªæ”¶è²¨
   - ç³»çµ±ç‹€æ…‹æ›´æ–°ç‚ºã€Œå·²æ”¶è²¨ã€

5. **è™•ç†é€€æ¬¾** (PROCESSING â†’ COMPLETED)
   - ç®¡ç†å“¡é–‹å§‹è™•ç†é€€æ¬¾
   - å®Œæˆå¾Œç³»çµ±è‡ªå‹•ï¼š
     - æ¢å¾©å•†å“åº«å­˜ï¼ˆåŒ…æ‹¬å°ºç¢¼åº«å­˜ï¼‰
     - ç™¼æ”¾è³¼ç‰©é‡‘çµ¦å®¢æˆ¶ï¼ˆæœ‰æ•ˆæœŸ 6 å€‹æœˆï¼‰
     - æ›´æ–°è¨‚å–®ç‹€æ…‹ç‚ºã€Œå·²é€€æ¬¾ã€

#### é€€è²¨ç‹€æ…‹èªªæ˜
- **REQUESTED**: å¾…å¯©æ ¸ - ç­‰å¾…è³£å®¶å¯©æ ¸
- **APPROVED**: å·²æ‰¹å‡† - è«‹è‡³ 711 å¯„ä»¶
- **REJECTED**: å·²æ‹’çµ• - é€€è²¨ç”³è«‹è¢«æ‹’çµ•
- **RECEIVED**: å·²æ”¶è²¨ - è³£å®¶å·²æ”¶åˆ°é€€è²¨
- **PROCESSING**: è™•ç†ä¸­ - é€€æ¬¾è™•ç†ä¸­
- **COMPLETED**: å·²å®Œæˆ - é€€æ¬¾å®Œæˆ
- **CANCELLED**: å·²å–æ¶ˆ - é€€è²¨å·²å–æ¶ˆ

**è³‡æ–™è¡¨**: `returns`, `return_items`

**API**:
```graphql
# å®¢æˆ¶ç«¯
myReturns                                    # æŸ¥è©¢æˆ‘çš„é€€è²¨ç”³è«‹
createReturn(input: CreateReturnInput!)      # å‰µå»ºé€€è²¨ç”³è«‹
uploadReturnTrackingNumber(...)              # ä¸Šå‚³å¯„ä»¶å–®è™Ÿ

# ç®¡ç†å“¡
allReturns(status: ReturnStatus)             # æŸ¥è©¢æ‰€æœ‰é€€è²¨ç”³è«‹
updateReturnStatus(id: ID!, input: ...)      # æ›´æ–°é€€è²¨ç‹€æ…‹
```

---

### 8. ç¤¾ç¾¤å¹³å°é€£çµç®¡ç†
**å¾Œå°**: `/admin/social-links`

**åŠŸèƒ½**ï¼š
- ç®¡ç†ç¤¾ç¾¤å¹³å°å¸³è™Ÿé€£çµ
- æ”¯æ´å¤šå¹³å°ï¼ˆFacebook/Instagram/LINE/Twitter ç­‰ï¼‰
- è‡ªè¨‚é¡¯ç¤ºåç¨±å’Œåœ–ç¤º
- æ’åºæ§åˆ¶
- å•Ÿç”¨/åœç”¨ç®¡ç†

**è³‡æ–™è¡¨**: `social_links`

---

### 9. ç”¢å“åœ–ç‰‡ä¸Šå‚³åŠŸèƒ½

**åŠŸèƒ½**ï¼š
- æ”¯æ´ä¸Šå‚³åœ–ç‰‡åˆ°æœ¬åœ° `/public/uploads/products/` ç›®éŒ„
- æ”¯æ´å¤šå¼µåœ–ç‰‡ï¼ˆæœ€å¤š 8 å¼µï¼‰
- æ”¯æ´æ‹–æ‹½æ’åºå’Œåˆªé™¤
- åœ–ç‰‡é©—è­‰ï¼ˆæ ¼å¼ã€å¤§å°é™åˆ¶ï¼‰

**API ç«¯é»**: `/api/upload`

---

## ğŸ” æ¬Šé™èˆ‡å®‰å…¨

### é›™è»Œèªè­‰ç³»çµ±

| æ¶ˆè²»è€… | ç®¡ç†å“¡ |
|--------|--------|
| **è·¯å¾‘**: `/auth/login`<br>**æ–¹å¼**: LINE Login + OTP<br>**æµç¨‹**: LINE æˆæ¬Š â†’ ç™¼é€ OTP â†’ é©—è­‰å®Œæˆ | **è·¯å¾‘**: `/admin/login`<br>**å¿«é€Ÿç™»å…¥ç¢¼**: `admin0900`<br>**éš”é›¢**: èˆ‡æ¶ˆè²»è€…ç³»çµ±å®Œå…¨åˆ†é›¢ |

**è§’è‰²**: USER (ä¸€èˆ¬ç”¨æˆ¶) / ADMIN (ç®¡ç†å“¡)

<details>
<parameter name="summary"><b>ğŸ”§ æŠ€è¡“å¯¦ç¾ç´°ç¯€ï¼ˆé»æ“Šå±•é–‹ï¼‰</b></summary>

**æ ¸å¿ƒæ–‡ä»¶**:
- `src/lib/line.ts` - LINE OAuth & Messaging API
- `src/lib/otp.ts` - OTP ç”Ÿæˆ/ç™¼é€/é©—è­‰
- `src/graphql/resolvers/authResolvers.ts` - èªè­‰ API

**GraphQL Mutations**ï¼š
```graphql
# æ­¥é©Ÿ 1ï¼šå–å¾— LINE ç™»å…¥ URL
mutation GetLineLoginUrl {
  getLineLoginUrl {
    url
  }
}

# æ­¥é©Ÿ 2ï¼šLINE å›èª¿å¾Œç™¼é€ OTP
mutation LineLoginCallback($code: String!) {
  lineLoginCallback(code: $code) {
    lineUserId
    displayName
    pictureUrl
    isNewUser
    otpSent
    expiresAt
  }
}

# æ­¥é©Ÿ 3ï¼šé©—è­‰ OTP ä¸¦å®Œæˆè¨»å†Š/ç™»å…¥
mutation VerifyLineOtp(
  $lineUserId: String!
  $code: String!
  $name: String
  $phone: String
) {
  verifyLineOtp(
    lineUserId: $lineUserId
    code: $code
    name: $name
    phone: $phone
  ) {
    token
    user {
      id
      name
      email
      phone
      role
    }
  }
}

# æ­¥é©Ÿ 4ï¼šé‡æ–°ç™¼é€ OTP
mutation ResendLineOtp($lineUserId: String!) {
  resendLineOtp(lineUserId: $lineUserId) {
    success
    message
    expiresAt
  }
}

# ç®¡ç†å“¡å¿«é€Ÿç™»å…¥
mutation AdminQuickLogin($code: String!) {
  adminQuickLogin(code: $code) {
    token
    user {
      id
      name
      email
      role
    }
  }
}
```

**å®‰å…¨ç‰¹æ€§**ï¼š
- âœ… OTP æœ‰æ•ˆæœŸé™ï¼š10 åˆ†é˜
- âœ… æœ€å¤§å˜—è©¦æ¬¡æ•¸ï¼š5 æ¬¡
- âœ… é‡ç™¼å†·å»æ™‚é–“ï¼š60 ç§’
- âœ… è‡ªå‹•æ¸…ç†éæœŸ OTP
- âœ… JWT Token èªè­‰
- âœ… é›™è»Œèªè­‰ç³»çµ±ï¼ˆæ¶ˆè²»è€… LINE / ç®¡ç†å“¡å¿«é€Ÿç™»å…¥ï¼‰
- âœ… æ¶ˆè²»è€…ç«¯ç„¡å¯†ç¢¼è¨­è¨ˆï¼ˆLINE OAuthï¼‰

**æˆæœ¬å„ªå‹¢**ï¼š
- LINE Messaging APIï¼š**å…è²»é¡åº¦ 500 å‰‡/æœˆ**
- è¶…éå¾Œï¼šNT$0.2 / å‰‡ï¼ˆæ¯” SMS ä¾¿å®œ 70%ï¼‰
- å°ç£ç”¨æˆ¶ LINE æ™®åŠç‡æ¥µé«˜

#### LINE API è¨­å®šæŒ‡å—

1. **å‰µå»º LINE Developers å¸³è™Ÿ**
   - å‰å¾€ï¼šhttps://developers.line.biz/
   - å‰µå»º Provider

2. **è¨­å®š LINE Login Channel**
   - å‰µå»ºæ–° Channelï¼ˆé¡å‹ï¼šLINE Loginï¼‰
   - è¨˜éŒ„ Channel ID å’Œ Channel Secret
   - è¨­å®š Callback URLï¼š`http://localhost:3000/api/auth/line/callback`

3. **è¨­å®š LINE Messaging API**
   - å‰µå»ºæ–° Channelï¼ˆé¡å‹ï¼šMessaging APIï¼‰
   - è¨˜éŒ„ Channel Access Token
   - è¨˜éŒ„å®˜æ–¹å¸³è™Ÿ IDï¼ˆ@é–‹é ­ï¼‰
   - é—œé–‰ã€Œè‡ªå‹•å›è¦†è¨Šæ¯ã€
   - å•Ÿç”¨ã€ŒWebhookã€ï¼ˆé¸å¡«ï¼‰

4. **æ›´æ–°ç’°å¢ƒè®Šæ•¸**
   - å°‡ä¸Šè¿°æ†‘è­‰å¡«å…¥ `.env`

---

### ğŸ›¡ï¸ å¤šå±¤å®‰å…¨é˜²è­·

#### 1. ä¼ºæœå™¨ç«¯è·¯ç”±ä¿è­· (`middleware.ts`)
æ‰€æœ‰æ•æ„Ÿè·¯ç”±åœ¨ä¼ºæœå™¨ç«¯é€²è¡Œæ¬Šé™æ””æˆªï¼š

| è·¯ç”± | æ¬Šé™è¦æ±‚ | æœªæˆæ¬Šè¡Œç‚º |
|------|---------|-----------|
| `/admin/login` | ç„¡ï¼ˆå…¬é–‹ï¼‰ | å…è¨±è¨ªå• |
| `/admin/*` | ADMIN è§’è‰² | æœªç™»å…¥ â†’ è·³è½‰ `/admin/login`<br>éç®¡ç†å“¡ â†’ 403 éŒ¯èª¤é  |
| `/account/*` | éœ€è¦ç™»å…¥ | è·³è½‰ `/auth/login`ï¼ˆå¸¶ redirect åƒæ•¸ï¼‰|
| `/checkout` | éœ€è¦ç™»å…¥ | è·³è½‰ `/auth/login` |

**é—œéµä¿è­·æ©Ÿåˆ¶**ï¼š
- Token é©—è­‰ï¼ˆæ”¯æ´ Cookie å’Œ Authorization Headerï¼‰
- JWT è§£æèˆ‡è§’è‰²æª¢æŸ¥
- ç®¡ç†å“¡å°ˆå±¬ç™»å…¥é é¢ï¼ˆ`/admin/login`ï¼‰ç¨ç«‹æ–¼æ¶ˆè²»è€…ç™»å…¥
- è‡ªå‹•è·³è½‰åˆ°ç™»å…¥é ä¸¦ä¿ç•™åŸå§‹ URLï¼ˆ`?redirect=/original/path`ï¼‰
- 403 ç¦æ­¢è¨ªå•é é¢ï¼ˆå«å‹å–„æç¤ºï¼‰

#### 2. å®¢æˆ¶ç«¯æ¬Šé™æª¢æŸ¥ (`AdminAuthGuard.tsx`)
é›™é‡é˜²è­·çš„ç¬¬äºŒé“é˜²ç·šï¼š
- ä½¿ç”¨ `useAuth()` Hook æª¢æŸ¥ç”¨æˆ¶è§’è‰²
- è¼‰å…¥ç‹€æ…‹é¡¯ç¤ºï¼ˆé¿å…é–ƒçˆï¼‰
- éç®¡ç†å“¡è‡ªå‹•è·³è½‰åˆ° 403 é é¢
- é˜»æ­¢æœªæˆæ¬Šæ¸²æŸ“ï¼ˆä¸æœƒæ´©éœ²å¾Œå° DOM çµæ§‹ï¼‰

#### 3. å°èˆªæ¬„å‹•æ…‹é¡¯ç¤º (`MainNav.tsx`)
æ ¹æ“šç”¨æˆ¶è§’è‰²å‹•æ…‹æ§åˆ¶å°èˆªé …ç›®ï¼š
```tsx
{isAuthenticated && user?.role === 'ADMIN' && (
  <Link href="/admin">å¾Œå°ç®¡ç†</Link>
)}
```
- âœ… åªæœ‰ ADMIN èƒ½çœ‹åˆ°ã€Œå¾Œå°ç®¡ç†ã€é€£çµ
- âœ… æœªç™»å…¥æˆ–ä¸€èˆ¬ç”¨æˆ¶å®Œå…¨çœ‹ä¸åˆ°å¾Œå°å…¥å£
- âœ… æ¡Œé¢ç‰ˆå’Œæ‰‹æ©Ÿç‰ˆéƒ½å·²ä¿è­·

#### 4. GraphQL API æ¬Šé™æª¢æŸ¥
æ¯å€‹éœ€è¦æˆæ¬Šçš„ Resolver éƒ½æœƒæª¢æŸ¥ JWT Tokenï¼š
```typescript
const user = getUserFromHeader(context.request.headers.get('authorization'))
if (!user) throw new Error('æœªæˆæ¬Š')
if (user.role !== 'ADMIN') throw new Error('éœ€è¦ç®¡ç†å“¡æ¬Šé™')
```

---

### æœƒå“¡ç­‰ç´šç³»çµ±

**å®Œå…¨å‹•æ…‹é…ç½®** - å¾Œå°å¯è‡ªç”±æ–°å¢/åˆªé™¤/é‡å‘½åæœƒå“¡ç­‰ç´š

**é è¨­ç­‰ç´š**ï¼ˆå¯ä¿®æ”¹ï¼‰ï¼š
- **BRONZE** (éŠ…): $0 - $9,999
- **SILVER** (éŠ€): $10,000 - $49,999
- **GOLD** (é‡‘): $50,000 - $99,999
- **PLATINUM** (ç™½é‡‘): $100,000 - $199,999
- **DIAMOND** (é‘½çŸ³): $200,000+

**å‡ç´šæ©Ÿåˆ¶**ï¼š
- æ ¹æ“šç´¯è¨ˆæ¶ˆè²»è‡ªå‹•å‡ç´š (`src/lib/membership.ts`)
- å‡ç´šæ™‚ç™¼æ”¾çå‹µè³¼ç‰©é‡‘
- å¾Œå°å¯ä¸€éµé‡ç®—æ‰€æœ‰ç”¨æˆ¶ç­‰ç´š

</details>

---

## ğŸ“Š è³‡æ–™åº«çµæ§‹

### ä¸»è¦è³‡æ–™è¡¨
- `users` - ç”¨æˆ¶è³‡æ–™
- `products` - ç”¢å“è³‡æ–™
- `product_variants` - é¡è‰²è®Šé«”
- `size_charts` - å°ºç¢¼è¡¨
- `brands` - å“ç‰Œ
- `categories` - åˆ†é¡
- `orders` - è¨‚å–®
- `order_items` - è¨‚å–®é …ç›®
- `carts` - è³¼ç‰©è»Š
- `cart_items` - è³¼ç‰©è»Šé …ç›®
- `coupons` - æŠ˜åƒ¹åˆ¸
- `user_coupons` - ç”¨æˆ¶å„ªæƒ åˆ¸
- `user_credits` - è³¼ç‰©é‡‘
- `announcements` - å…¬å‘Š
- `referral_codes` - é‚€è«‹ç¢¼
- `referral_usages` - é‚€è«‹ç¢¼ä½¿ç”¨è¨˜éŒ„
- `conversations` - å°è©±
- `messages` - è¨Šæ¯
- `social_links` - ç¤¾ç¾¤é€£çµ
- `returns` - é€€è²¨ç”³è«‹
- `return_items` - é€€è²¨é …ç›®
- `reviews` - è©•è«–

### æ ¸å¿ƒè³‡æ–™è¡¨é—œè¯

```
User (ç”¨æˆ¶)
â”œâ”€â”€ Cart (è³¼ç‰©è»Š)
â”‚   â””â”€â”€ CartItem (è³¼ç‰©è»Šé …ç›®)
â”œâ”€â”€ Order (è¨‚å–®)
â”‚   â””â”€â”€ OrderItem (è¨‚å–®é …ç›®)
â”œâ”€â”€ UserCredit (è³¼ç‰©é‡‘)
â”œâ”€â”€ ReferralCode (é‚€è«‹ç¢¼)
â”œâ”€â”€ Review (è©•è«–)
â””â”€â”€ Conversation (å°è©±)

Product (ç”¢å“)
â”œâ”€â”€ ProductVariant (é¡è‰²è®Šé«”)
â”œâ”€â”€ SizeChart (å°ºç¢¼è¡¨)
â”œâ”€â”€ CartItem
â”œâ”€â”€ OrderItem
â””â”€â”€ Review

Order (è¨‚å–®)
â”œâ”€â”€ OrderItem
â”œâ”€â”€ Address (æ”¶è²¨åœ°å€)
â”œâ”€â”€ Coupon (å„ªæƒ åˆ¸)
â””â”€â”€ Return (é€€è²¨ç”³è«‹)
```

### é‡è¦æ¬„ä½èªªæ˜

**Product é‹åº—å°ˆå±¬æ¬„ä½**ï¼š
- `shoeType` - é‹é¡å‹ï¼ˆé‹å‹•é‹ã€çš®é‹ã€æ¶¼é‹ã€é´å­ï¼‰
- `gender` - æ€§åˆ¥ï¼ˆç”·ã€å¥³ã€ä¸­æ€§ã€å…’ç«¥ï¼‰
- `season` - å­£ç¯€ï¼ˆæ˜¥å¤ã€ç§‹å†¬ã€å››å­£ï¼‰
- `heelHeight` - é‹è·Ÿé«˜åº¦
- `closure` - é–‰åˆæ–¹å¼ï¼ˆç³»å¸¶ã€é­”è¡“è²¼ã€æ‹‰éˆã€å¥—è„šï¼‰
- `sole` - é‹åº•æè³ª

**SizeChart å°ºç¢¼å°ç…§è¡¨**ï¼š
- `eu`, `us`, `uk`, `cm` - å››ç¨®å°ºç¢¼æ¨™æº–
- `footLength` - è…³é•·ï¼ˆå˜ç±³ï¼‰
- `stock` - è©²å°ºç¢¼çš„ç¨ç«‹åº«å­˜

**UserCredit è³¼ç‰©é‡‘**ï¼š
- `balance` - é¤˜é¡ï¼ˆå¯èƒ½è¢«éƒ¨åˆ†ä½¿ç”¨ï¼‰
- `maxUsagePerOrder` - å–®ç­†è¨‚å–®æœ€å¤§ä½¿ç”¨é¡
- `minOrderAmount` - æœ€ä½è¨‚å–®é‡‘é¡é™åˆ¶
- `validUntil` - æœ‰æ•ˆæœŸé™

---

## âš¡ æ•ˆèƒ½å„ªåŒ–

### ğŸ”¥ é—œéµæŒ‡æ¨™

| æŒ‡æ¨™ | å„ªåŒ–å‰ | å„ªåŒ–å¾Œ | æå‡ |
|------|--------|--------|------|
| é¦–å±è¼‰å…¥ (FCP) | 3s | 0.8s | 3.75x |
| æœ€å¤§å…§å®¹ç¹ªè£½ (LCP) | 4s | 1.2s | 3.3x |
| API éŸ¿æ‡‰æ™‚é–“ | 500ms | 10-30ms | 20x |
| Lighthouse åˆ†æ•¸ | 65 | 95+ | +46% |
| ä¸¦ç™¼æ”¯æŒ | 100 req/s | 500-1000 req/s | 5-10x |

### âœ… å·²å®Œæˆå„ªåŒ–

**å‰ç«¯**
- Next.js Image è‡ªå‹•å„ªåŒ– (AVIF/WebP)
- ä»£ç¢¼åˆ†å‰² & å‹•æ…‹å°å…¥
- Server Components (æ¸›å°‘ 30KB bundle)
- PWA & Service Worker

**å¾Œç«¯**
- Redis å¿«å– (å‘½ä¸­ç‡ 70-90%)
- SSR ç›´æ¥ Prisma æŸ¥è©¢
- GraphQL N+1 ä¿®å¾© (æŸ¥è©¢æ¸›å°‘ 97.5%)
- è³‡æ–™åº«ç´¢å¼• (50+ å€‹)
- API é™æµ (100 req/min)

<details>
<summary><b>ğŸ“Š è©³ç´°å„ªåŒ–è¨˜éŒ„ï¼ˆé»æ“Šå±•é–‹ï¼‰</b></summary>

### åœ–ç‰‡è¼‰å…¥å„ªåŒ–
- ç§»é™¤å¤–éƒ¨ Unsplash åœ–ç‰‡
- æ‡¶è¼‰å…¥éé—œéµåœ–ç‰‡
- é¦–å±è¼‰å…¥æ¸›å°‘ 80%

### å¿«å–ç­–ç•¥
- ç”¢å“å¿«å–: 5 åˆ†é˜
- ç†±é–€è³‡æ–™å¿«å–: 1 å°æ™‚
- Cache-Aside æ¨¡å¼

### å•Ÿç”¨æ–¹å¼
```bash
# å•Ÿå‹• Redis
brew services start redis

# ä½¿ç”¨å„ªåŒ–é…ç½®
cp next.config.optimized.js next.config.js

# æ€§èƒ½æ¸¬è©¦
npx lighthouse http://localhost:3000 --view
```

</details>

---

## ğŸ“ API æ–‡æª”

GraphQL API ä½æ–¼ `/api/graphql`

### ä¸»è¦ Queries
```graphql
# ç”¨æˆ¶
me
users

# ç”¢å“
products
product(id: ID, slug: String)
brands
categories

# è³¼ç‰©é‡‘
myCredits
availableCreditAmount

# é‚€è«‹ç¢¼
myReferralCode
referralStats

# å…¬å‘Š
activeAnnouncements

# èŠå¤©
myConversations
conversation(id: ID)

# é€€è²¨
myReturns
allReturns(status: ReturnStatus)
```

### ä¸»è¦ Mutations
```graphql
# èªè­‰
getLineLoginUrl
lineLoginCallback(code: String!)
verifyLineOtp(lineUserId: String!, code: String!, name: String, phone: String)
resendLineOtp(lineUserId: String!)
adminQuickLogin(code: String!)

# ç”¢å“ç®¡ç†
createProduct(input: CreateProductInput!)
updateProduct(id: ID!, input: UpdateProductInput!)
deleteProduct(id: ID!)
createBrand(input: CreateBrandInput!)
updateBrand(id: ID!, input: UpdateBrandInput!)
deleteBrand(id: ID!)
createCategory(input: CreateCategoryInput!)
updateCategory(id: ID!, input: UpdateCategoryInput!)
deleteCategory(id: ID!)

# è³¼ç‰©é‡‘
grantCredit(input: GrantCreditInput!)
batchGrantCredit(input: BatchGrantCreditInput!)

# é‚€è«‹ç¢¼
useReferralCode(code: String!, userId: String!)

# å…¬å‘Š
createAnnouncement(input: CreateAnnouncementInput!)

# èŠå¤©
createConversation(subject: String, message: String!)
sendMessage(conversationId: ID!, content: String!)

# é€€è²¨
createReturn(input: CreateReturnInput!)
uploadReturnTrackingNumber(returnId: ID!, trackingNumber: String!)
updateReturnStatus(id: ID!, input: UpdateReturnStatusInput!)
```

### GraphQL API ä½¿ç”¨ç¯„ä¾‹

#### æŸ¥è©¢ç”¢å“
```graphql
query GetProduct($slug: String!) {
  product(slug: $slug) {
    id
    name
    price
    variants {
      id
      color
      colorHex
      stock
    }
    sizeCharts {
      eu
      us
      uk
      cm
      stock
    }
  }
}
```

#### ä½¿ç”¨è³¼ç‰©é‡‘çµå¸³
```graphql
mutation CreateOrder($input: CreateOrderInput!) {
  createOrder(input: $input) {
    id
    orderNumber
    total
    creditUsed  # ä½¿ç”¨çš„è³¼ç‰©é‡‘é‡‘é¡
  }
}
```

#### æŸ¥è©¢é‚€è«‹ç¢¼çµ±è¨ˆ
```graphql
query MyReferralStats {
  myReferralCode {
    code
    usedCount
    totalRewards
  }
  referralStats {
    totalReferrals
    successfulOrders
    totalRewardAmount
  }
}
```

---

## ğŸ”‘ æ¸¬è©¦å¸³è™Ÿ

### ğŸš€ ç®¡ç†å“¡å¿«é€Ÿç™»å…¥

è¨ªå• `/admin/login` ä¸¦è¼¸å…¥å¿«é€Ÿç™»å…¥ç¢¼: **`admin0900`**

<details>
<summary>ç®¡ç†å“¡å¸³è™Ÿè³‡è¨Š</summary>

- Email: `admin@shoe.com`
- æ‰‹æ©Ÿ: `0900000000`
- è§’è‰²: ADMIN
- æœƒå“¡ç­‰ç´š: DIAMOND

</details>

### ğŸ‘¥ æ¶ˆè²»è€…ç™»å…¥

è¨ªå• `/auth/login` ä½¿ç”¨ **LINE Login** ç™»å…¥ï¼ˆå”¯ä¸€æ–¹å¼ï¼‰

**æç¤º**: åŸ·è¡Œ `pnpm db:seed` å¯ç”Ÿæˆæ¸¬è©¦è³‡æ–™

---

## ğŸ§ª æ¸¬è©¦

```bash
# å–®å…ƒæ¸¬è©¦
pnpm test

# æ¸¬è©¦ç›£è¦–æ¨¡å¼
pnpm test:watch

# æ¸¬è©¦è¦†è“‹ç‡
pnpm test:coverage
```

### æ¸¬è©¦ç‹€æ…‹ï¼ˆ2025-10-27ï¼‰
âœ… **æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦é€šé** - ç”¢å“å±•ç¤ºã€è³¼ç‰©è»Šã€è©•è«–ç³»çµ±
âœ… **å®‰å…¨æ¸¬è©¦é€šé** - JWT èªè­‰ã€å¯†ç¢¼åŠ å¯†ã€XSS/SQL æ³¨å…¥é˜²è­·ã€API é™æµ
âœ… **æª”æ¡ˆå®Œæ•´æ€§æª¢æŸ¥é€šé** - å‰å¾Œç«¯çµ„ä»¶ã€API è·¯ç”±å®Œæ•´

---

## ğŸš€ éƒ¨ç½²

### ç”Ÿç”¢ç’°å¢ƒæª¢æŸ¥æ¸…å–®
- [ ] è¨­å®šç”Ÿç”¢ç’°å¢ƒè®Šæ•¸
- [ ] åŸ·è¡Œè³‡æ–™åº«é·ç§»
- [ ] åŸ·è¡Œæ•ˆèƒ½å„ªåŒ– SQL è…³æœ¬
- [ ] å•Ÿå‹• Redis æœå‹™å™¨
- [ ] é©—è­‰å¿«å–å‘½ä¸­ç‡ > 70%
- [ ] é…ç½® Prisma é€£æ¥æ± 
- [ ] é…ç½® CDNï¼ˆåœ–ç‰‡ï¼‰
- [ ] è¨­å®š HTTPS
- [ ] é…ç½®ç›£æ§å’Œæ—¥èªŒï¼ˆSentry/Datadogï¼‰
- [ ] å£“åŠ›æ¸¬è©¦ï¼ˆç¢ºä¿æ”¯æŒ 500+ req/sï¼‰

### å»ºè­°éƒ¨ç½²å¹³å°
- **å…¨ç«¯æ‡‰ç”¨**: Vercel / Netlify
- **è³‡æ–™åº«**: Supabase / Railway / Neon
- **Redis**: Upstash / Redis Cloud
- **åœ–ç‰‡ CDN**: Cloudflare R2 / AWS S3 / Vercel Blob

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œå¿«é€Ÿè§£æ±º

| å•é¡Œ | è§£æ±ºæ–¹æ¡ˆ |
|------|----------|
| **Prisma Client éŒ¯èª¤** | `pnpm db:generate && pnpm dev` |
| **è³‡æ–™åº«é€£ç·šå¤±æ•—** | `brew services restart postgresql` |
| **GraphQL æ¬Šé™éŒ¯èª¤** | `localStorage.clear()` å¾Œé‡æ–°ç™»å…¥ |
| **å¾Œå°å¡åœ¨ Loading** | æ¸…é™¤ç€è¦½å™¨å¿«å–ä¸¦é‡æ–°æ•´ç† |
| **é·ç§»å¤±æ•—** | `pnpm prisma migrate status` æª¢æŸ¥ç‹€æ…‹ |

### è³‡æ–™åº«é·ç§»å®‰å…¨è¦å‰‡

âš ï¸ **ç¦æ­¢ä½¿ç”¨ `--accept-data-loss` åƒæ•¸**

```bash
# å‚™ä»½è³‡æ–™åº«
pg_dump shoe_store > backup.sql

# å®‰å…¨é·ç§»
pnpm db:migrate

# é–‹ç™¼ç’°å¢ƒé‡ç½® (å±éšª!æœƒæ¸…ç©ºè³‡æ–™)
pnpm prisma migrate reset
```

<details>
<summary><b>ğŸ” æ­·å²å•é¡Œèˆ‡ä¿®å¾©è¨˜éŒ„ï¼ˆé»æ“Šå±•é–‹ï¼‰</b></summary>

### éŒ¯èª¤è™•ç†è¦ç¯„
```typescript
// âœ… æ­£ç¢º:å®Œæ•´é¡¯ç¤ºéŒ¯èª¤
throw new Error(`ç„¡æ³•æ›´æ–°ç”¢å“:åº«å­˜ä¸è¶³ (å¯ç”¨: ${stock}, éœ€æ±‚: ${quantity})`)

// å‰ç«¯æ¥æ”¶
catch (error: any) {
  toast.error(error.graphQLErrors?.[0]?.message || 'æ“ä½œå¤±æ•—')
}
```

### æ¥­å‹™é‚è¼¯é™åˆ¶
- **è³¼ç‰©é‡‘**: éœ€æª¢æŸ¥æœ‰æ•ˆæœŸã€æœ€ä½è¨‚å–®é‡‘é¡ã€æœ€å¤§ä½¿ç”¨é¡
- **é‚€è«‹ç¢¼**: ä¸èƒ½ä½¿ç”¨è‡ªå·±çš„ã€æ¯äººé™ç”¨ä¸€æ¬¡
- **é€€è²¨**: åªæœ‰ã€Œå·²é€é”ã€æˆ–ã€Œå·²å®Œæˆã€è¨‚å–®å¯ç”³è«‹

</details>

---

## ğŸ“ æ›´æ–°æ—¥èªŒ

### æœ€è¿‘æ›´æ–° (2025-10-29)

- ğŸ› ä¿®å¾©è³¼ç‰©è»ŠæŸ¥è©¢å¤±æ•— (Context æ¬„ä½ä¸åŒ¹é…)
- ğŸ› ä¿®å¾©å…¨ç«™ç¼ºå°‘å°èˆª Header
- ğŸ¨ å…¬å‘Šç³»çµ±æ”¹ç‚ºå½ˆçª—å¼ + æ™ºèƒ½æ›´æ–°æª¢æ¸¬
- â™¿ å¾Œå°å­—é«”å…¨é¢æ”¾å¤§ (æå‡å¯è®€æ€§)
- ğŸ› ä¿®å¾©å…¬å‘Šç·¨è¼¯å¾Œå½ˆçª—ç‹€æ…‹ç•°å¸¸

<details>
<summary><b>ğŸ“‹ å®Œæ•´æ›´æ–°è¨˜éŒ„ï¼ˆé»æ“Šå±•é–‹ï¼‰</b></summary>

### 2025-10-29

#### ğŸ› Bug ä¿®å¾©ï¼šè³¼ç‰©è»ŠæŸ¥è©¢å¤±æ•— - Context userId æ¬„ä½ä¸åŒ¹é…
- **å•é¡Œ**: è³¼ç‰©è»ŠæŸ¥è©¢å¤±æ•—ï¼ŒéŒ¯èª¤è¨Šæ¯ï¼š`Argument 'where' of type CartWhereUniqueInput needs at least one of 'id' or 'userId' arguments. userId: undefined`
- **æ ¹æœ¬åŸå› **: GraphQL Context è¿”å›çš„çµæ§‹æ˜¯ `context.user.userId`ï¼Œä½† `cartResolvers.ts` ä½¿ç”¨çš„æ˜¯ `context.user.id`
- **å…·é«”éŒ¯èª¤ä½ç½®**:
  - `app/api/graphql/route.ts:60-66` - Context è¿”å› `{ userId, email, role }`
  - `src/graphql/resolvers/cartResolvers.ts` - æ‰€æœ‰åœ°æ–¹ä½¿ç”¨ `context.user.id`ï¼ˆéŒ¯èª¤ï¼‰
- **ä¿®å¾©å…§å®¹**:
  - çµ±ä¸€ Context interface å®šç¾©ç‚º `{ userId: string, email: string, role: string }`
  - å°‡æ‰€æœ‰ `context.user.id` æ”¹ç‚º `context.user.userId`ï¼ˆå…± 7 è™•ï¼‰
  - ä¿®æ­£ä½ç½®ï¼šQuery.cartã€addToCartã€updateCartItemã€removeFromCartã€clearCart
- **å½±éŸ¿ç¯„åœ**: æ‰€æœ‰éœ€è¦èªè­‰çš„è³¼ç‰©è»Šæ“ä½œ
- **ä¿®æ”¹æª”æ¡ˆ**: `src/graphql/resolvers/cartResolvers.ts`
- **æ¸¬è©¦ç¢ºèª**: âœ… ç”¨æˆ¶ç™»å…¥å¾Œå¯æ­£å¸¸æŸ¥è©¢è³¼ç‰©è»Š

#### ğŸ› Bug ä¿®å¾©ï¼šå…¨ç«™ç¼ºå°‘å°èˆª Header
- **å•é¡Œ**: `/products` åŠæ‰€æœ‰é é¢éƒ½æ²’æœ‰é¡¯ç¤ºå°èˆª header
- **æ ¹æœ¬åŸå› **: `app/layout.tsx` ä¸­æ²’æœ‰å°å…¥å’Œæ¸²æŸ“ `MainNav` çµ„ä»¶
- **ä¿®å¾©å…§å®¹**:
  - åœ¨ `app/layout.tsx` ä¸­å°å…¥ `MainNav` çµ„ä»¶
  - å°‡ `MainNav` æ·»åŠ åˆ° layout ä¸­ï¼Œç¢ºä¿æ‰€æœ‰é é¢éƒ½æœ‰å°èˆª
  - ç‚ºä¸»å…§å®¹å€åŸŸæ·»åŠ  `pt-16` ä¸Šé‚Šè·ï¼Œé¿å…å…§å®¹è¢«å›ºå®šå®šä½çš„ header é®æ“‹
- **å½±éŸ¿ç¯„åœ**: æ‰€æœ‰å‰å°é é¢ï¼ˆé¦–é ã€ç”¢å“é ã€è³¼ç‰©è»Šã€è¨‚å–®ç­‰ï¼‰
- **ä¿®æ”¹æª”æ¡ˆ**: `app/layout.tsx`

#### ğŸ¨ UI/UX æ”¹é€²ï¼šå…¬å‘Šç³»çµ±æ”¹ç‚ºå½ˆçª—å¼é¡¯ç¤ºï¼ˆå«æ™ºèƒ½æ›´æ–°æª¢æ¸¬ï¼‰
- **ç›®æ¨™**: è§£æ±ºé¦–é å…¬å‘Šæ©«å¹…å †ç–Šé€ æˆç‰ˆé¢æ“æ“ çš„å•é¡Œ
- **æ”¹é€²å…§å®¹**:
  - å°‡å…¬å‘Šå¾æ©«å¹…å¼æ”¹ç‚ºå½ˆçª—å¼é¡¯ç¤º
  - æ‰€æœ‰å…¬å‘Šé›†ä¸­åœ¨ä¸€å€‹å½ˆçª—ä¸­ï¼Œå¯æ»¾å‹•ç€è¦½
  - ç”¨æˆ¶å¯é¸æ“‡ã€Œç¨å¾Œå†çœ‹ã€ï¼ˆè‡¨æ™‚é—œé–‰ï¼‰æˆ–ã€Œä¸å†é¡¯ç¤ºã€ï¼ˆæ°¸ä¹…é—œé–‰ï¼‰
  - æ¯å€‹å…¬å‘Šéƒ½æœ‰ç¨ç«‹çš„é—œé–‰æŒ‰éˆ•
  - ä½¿ç”¨ localStorage æŒä¹…åŒ–è¨˜éŒ„å·²é—œé–‰çš„å…¬å‘Š
  - é®ç½©å±¤é»æ“Šå¯è‡¨æ™‚é—œé–‰å½ˆçª—
  - **æ”¹ç”¨ `network-only` fetch policy**ï¼Œç¢ºä¿æ¯æ¬¡éƒ½ç²å–æœ€æ–°å…¬å‘Š
- **ğŸ”¥ æ™ºèƒ½æ›´æ–°æª¢æ¸¬** âœ¨ï¼ˆè§£æ±ºå¾Œå°æ›´æ–°å…¬å‘Šä¸é¡¯ç¤ºçš„å•é¡Œï¼‰:
  - localStorage ç¾åœ¨è¨˜éŒ„ã€Œå…¬å‘Š ID + é—œé–‰æ™‚é–“ã€è€Œä¸åªæ˜¯ ID
  - æ¯æ¬¡æŸ¥è©¢å…¬å‘Šæ™‚ï¼Œæ¯”å° `å…¬å‘Šçš„ updatedAt` å’Œ `ç”¨æˆ¶çš„é—œé–‰æ™‚é–“`
  - **å¦‚æœå…¬å‘Šåœ¨ç”¨æˆ¶é—œé–‰å¾Œè¢«æ›´æ–°ï¼Œæœƒè‡ªå‹•é‡æ–°é¡¯ç¤º** ğŸ¯
  - ä¾‹å¦‚ï¼šç”¨æˆ¶åœ¨ 10:00 é—œé–‰å…¬å‘Š Aï¼Œç®¡ç†å“¡åœ¨ 10:30 æ›´æ–°å…¬å‘Š A çš„å…§å®¹ï¼Œç”¨æˆ¶ä¸‹æ¬¡è¨ªå•æœƒå†æ¬¡çœ‹åˆ°å…¬å‘Š A
  - Console æœƒè¼¸å‡ºå“ªäº›å…¬å‘Šå› ç‚ºæ›´æ–°è€Œé‡æ–°é¡¯ç¤º
- **é–‹ç™¼è€…å·¥å…·** ğŸ”§ï¼ˆå¯é¸ï¼Œé è¨­é—œé–‰ï¼‰:
  - åœ¨ `AnnouncementModal.tsx` ä¸­å°‡ `ENABLE_DEBUG_TOOLS` è¨­ç‚º `true` å¯å•Ÿç”¨
  - å•Ÿç”¨å¾Œåœ¨é–‹ç™¼ç’°å¢ƒä¸‹é¡¯ç¤ºèª¿è©¦é¢æ¿ï¼ˆç”Ÿç”¢ç’°å¢ƒè‡ªå‹•ç¦ç”¨ï¼‰
  - å¯¦æ™‚é¡¯ç¤ºï¼šå¾Œç«¯æ´»èºå…¬å‘Šæ•¸é‡ã€å·²é—œé–‰å…¬å‘Šæ•¸é‡ã€å¯é¡¯ç¤ºå…¬å‘Šæ•¸é‡
  - ä¸€éµæ¸…é™¤æ‰€æœ‰å·²é—œé–‰è¨˜éŒ„ä¸¦é‡æ–°è¼‰å…¥
  - ç•¶æœ‰å…¬å‘Šä½†éƒ½è¢«é—œé–‰æ™‚ï¼Œå³ä¸‹è§’é¡¯ç¤ºæç¤ºå¡ç‰‡
  - Console è¼¸å‡ºè©³ç´°èª¿è©¦æ—¥èªŒï¼ŒåŒ…å«æ›´æ–°æª¢æ¸¬çµæœ
  - **é è¨­é—œé–‰èª¿è©¦å·¥å…·ï¼Œä¿æŒç•Œé¢ç°¡æ½”**
- **ä¿®æ”¹æª”æ¡ˆ**:
  - æ–°å¢ `components/common/AnnouncementModal.tsx` - å½ˆçª—çµ„ä»¶ï¼ˆå«æ™ºèƒ½æ›´æ–°æª¢æ¸¬ï¼‰
  - ä¿®æ”¹ `components/common/AnnouncementWrapper.tsx` - ä½¿ç”¨æ–°çš„å½ˆçª—çµ„ä»¶
  - ä¿ç•™ `components/common/AnnouncementBanner.tsx` - èˆŠç‰ˆæ©«å¹…çµ„ä»¶ï¼ˆæœªä½¿ç”¨ï¼‰
  - æ–°å¢ `scripts/debug-announcements.js` - è¨ºæ–·è…³æœ¬
- **localStorage ç‰ˆæœ¬å‡ç´š**:
  - èˆŠç‰ˆæœ¬: `dismissed_announcements` (åªå­˜ ID é™£åˆ—)
  - æ–°ç‰ˆæœ¬: `dismissed_announcements_v2` (å­˜ ID + é—œé–‰æ™‚é–“)
  - è‡ªå‹•å…¼å®¹èˆŠç‰ˆæœ¬ï¼Œæ¸…é™¤æ™‚æœƒåŒæ™‚æ¸…é™¤å…©å€‹ key
- **ä½¿ç”¨è€…é«”é©—æå‡**:
  - é¦–é ä¸å†è¢«å…¬å‘Šä½”æ“šå¤§é‡ç©ºé–“
  - ç”¨æˆ¶å¯è‡ªä¸»æ§åˆ¶æ˜¯å¦æŸ¥çœ‹å…¬å‘Š
  - å·²é—œé–‰çš„å…¬å‘Šä¸æœƒåœ¨ä¸‹æ¬¡è¨ªå•æ™‚å†æ¬¡é¡¯ç¤ºï¼ˆé™¤éè¢«æ›´æ–°ï¼‰
  - **å¾Œå°æ›´æ–°å…¬å‘Šå¾Œï¼Œç”¨æˆ¶ä¸€å®šæœƒå†æ¬¡çœ‹åˆ°** ğŸ‘
  - ç¾è§€çš„å½ˆçª—è¨­è¨ˆï¼Œç¬¦åˆç¾ä»£ UI æ¨™æº–
- **é–‹ç™¼é«”é©—æå‡**:
  - é–‹ç™¼ç’°å¢ƒä¸‹å¯å¿«é€Ÿè¨ºæ–·ç‚ºä»€éº¼å…¬å‘Šä¸é¡¯ç¤º
  - ç„¡éœ€æ‰“é–‹é–‹ç™¼è€…å·¥å…·æ‰‹å‹•æ¸…é™¤ localStorage
  - æ¸…æ¥šçœ‹åˆ°å¿«å–å’Œéæ¿¾é‚è¼¯çš„é‹ä½œç‹€æ³
  - æ›´æ–°æª¢æ¸¬é‚è¼¯æ¸…æ™°å¯è¦‹

#### â™¿ ç„¡éšœç¤™å„ªåŒ–ï¼šå¾Œå°å­—é«”å…¨é¢æ”¾å¤§
- **ç›®æ¨™**: æå‡å¹´é•·ä½¿ç”¨è€…çš„é–±è®€é«”é©—
- **å„ªåŒ–ç¯„åœ**:
  - Layout åŸºç¤å­—é«”ï¼šå¢åŠ åˆ° `text-lg`ï¼ˆ18pxï¼‰
  - æ¨™é¡Œå­—é«”ï¼š`text-xl` â†’ `text-2xl`ï¼ˆä¸»æ¨™é¡Œï¼‰ã€`text-lg` â†’ `text-xl`ï¼ˆå€å¡Šæ¨™é¡Œï¼‰
  - å°èˆªé¸å–®ï¼š`text-sm` â†’ `text-base`ï¼ˆé¸å–®é …ç›®ï¼‰ã€`text-xs` â†’ `text-sm`ï¼ˆåˆ†çµ„æ¨™é¡Œï¼‰
  - çµ±è¨ˆå¡ç‰‡ï¼šæ‰€æœ‰ `text-sm` â†’ `text-base`
  - ç‹€æ…‹æ¨™ç±¤ï¼š`text-xs` â†’ `text-sm`
  - æŒ‰éˆ•æ–‡å­—ï¼š`text-sm` â†’ `text-base`
- **ä¿®æ”¹æª”æ¡ˆ**:
  - `app/admin/layout.tsx` - åŸºç¤å­—é«”å¤§å°è¨­å®š
  - `components/admin/AdminNav.tsx` - å°èˆªé¸å–®å­—é«”
  - `app/admin/dashboard/page.tsx` - å„€è¡¨æ¿ç¤ºç¯„é é¢
- **å½±éŸ¿**: å‰å°å®Œå…¨ä¸å—å½±éŸ¿ï¼Œåªèª¿æ•´å¾Œå°ç®¡ç†ç³»çµ±
- **è¨­è¨ˆç†å¿µ**: ç…§é¡§å¹´é•·ä½¿ç”¨è€…çš„è¦–åŠ›éœ€æ±‚ï¼Œæå‡å¾Œå°æ“ä½œèˆ’é©åº¦

#### ğŸ› Bug ä¿®å¾©ï¼šå…¬å‘Šç·¨è¼¯å®Œæˆå¾Œå½ˆçª—ç‹€æ…‹ç•°å¸¸
- **å•é¡Œæè¿°**: å¾Œå°ç·¨è¼¯å…¬å‘Šå®Œæˆå¾Œ,å½ˆçª—æ²’æœ‰é—œé–‰,ä¸”æ¨™é¡ŒéŒ¯èª¤é¡¯ç¤ºç‚ºã€Œæ–°å¢å…¬å‘Šã€
- **æ ¹æœ¬åŸå› **: `updateAnnouncement` mutation çš„æˆåŠŸå›èª¿ä¸­ç¼ºå°‘ `setShowCreateModal(false)`,å°è‡´:
  - ç·¨è¼¯ç‹€æ…‹ (`editingAnnouncement`) è¢«æ¸…ç©º
  - ä½†å½ˆçª— (`showCreateModal`) ä»ç„¶ä¿æŒæ‰“é–‹
  - å› æ­¤æ¨™é¡Œåˆ¤æ–·é‚è¼¯é¡¯ç¤ºç‚ºã€Œæ–°å¢å…¬å‘Šã€
- **ä¿®å¾©å…§å®¹**: åœ¨ `onCompleted` å›èª¿ä¸­æ·»åŠ  `setShowCreateModal(false)`
- **ä¿®æ”¹æª”æ¡ˆ**: `app/admin/announcements/page.tsx:134`
- **å½±éŸ¿**: ç·¨è¼¯å…¬å‘Šå¾Œå½ˆçª—æœƒæ­£ç¢ºé—œé–‰,ä¸å†å‡ºç¾ç‹€æ…‹æ··äº‚

---

### 2025-10-28

#### âš¡ æ€§èƒ½å„ªåŒ–ï¼šSSR èˆ‡å®¢æˆ¶ç«¯æ¸²æŸ“å…¨é¢æå‡
- **SSR æŸ¥è©¢å„ªåŒ–**ï¼šå‰µå»º `src/lib/server-queries.ts` ä¼ºæœå™¨ç«¯æŸ¥è©¢åº«
  - ç›´æ¥ä½¿ç”¨ Prisma æŸ¥è©¢ï¼Œé¿å… SSR æ™‚é€šé HTTP å›æ‰“ `/api/graphql`
  - æ¸›å°‘ç¶²è·¯å¾€è¿”å»¶é² **50-100ms**
  - æ‰€æœ‰æŸ¥è©¢å‡½æ•¸ä½¿ç”¨ React `cache()` è‡ªå‹•å»é‡
- **å»é™¤é‡è¤‡æŸ¥è©¢**ï¼š
  - `app/products/[slug]/page.tsx` ä½¿ç”¨ React cache ç¢ºä¿ `generateMetadata` å’Œé é¢çµ„ä»¶å…±ç”¨æŸ¥è©¢çµæœ
  - åŒä¸€é é¢çš„é‡è¤‡æŸ¥è©¢å¾ **2 æ¬¡æ¸›å°‘åˆ° 1 æ¬¡**ï¼ˆè«‹æ±‚æ•¸æ¸›åŠï¼‰
- **ç§»é™¤é‡è¤‡ refetch**ï¼š
  - ä¿®å¾© `ProductListClient.tsx` ä¸­ useQuery è‡ªå‹•é‡æ–°æŠ“å– + useEffect æ‰‹å‹• refetch çš„é›™é‡è«‹æ±‚å•é¡Œ
  - ç¯©é¸æ“ä½œè§¸ç™¼çš„è«‹æ±‚å¾ **2 æ¬¡æ¸›å°‘åˆ° 1 æ¬¡**ï¼ˆéŸ¿æ‡‰å¿« 2 å€ï¼‰
- **Server Components å„ªåŒ–**ï¼š
  - å°‡ 4 å€‹ç´”å±•ç¤ºçµ„ä»¶æ”¹ç‚ºä¼ºæœå™¨çµ„ä»¶ï¼ˆHeroSectionã€ProductsSectionã€BrandsSectionã€AboutSectionï¼‰
  - å®¢æˆ¶ç«¯ JS bundle **æ¸›å°‘ç´„ 30KB**
  - é¦–å± hydration æ™‚é–“é¡¯è‘—ç¸®çŸ­
- **è·¯ç”±æ‹†åˆ†å„ªåŒ–**ï¼š
  - ç§»é™¤ `next.config.js` ä¸­ç ´å£ Next.js é è¨­å„ªåŒ–çš„è‡ªå®šç¾© splitChunks é…ç½®
  - æ¢å¾©è·¯ç”±ç´šåˆ¥çš„ç¨‹å¼ç¢¼æ‹†åˆ†ï¼Œé¦–å±è¼‰å…¥æ›´å¿«
- **åœ–ç‰‡å„ªåŒ–**ï¼š
  - åœ¨ `next.config.js` æ·»åŠ  `images.unsplash.com` åŸŸå
  - å•Ÿç”¨ Next.js Image è‡ªå‹•å„ªåŒ–ï¼ˆAVIF/WebP æ ¼å¼ã€éŸ¿æ‡‰å¼å°ºå¯¸ï¼‰
- **ç·¨ç¢¼ä¿®å¾©**ï¼š
  - ä¿®å¾© `app/orders/page.tsx` é UTF-8 å­—å…ƒå•é¡Œï¼Œç¢ºä¿ `pnpm build` æˆåŠŸ

**æ•´é«”æ•ˆèƒ½æå‡**ï¼š
- ç”¢å“è©³æƒ…é  SSR æ™‚é–“ï¼š**æ¸›å°‘ 50-100ms**
- åˆå§‹æ¸²æŸ“é€Ÿåº¦ï¼š**æå‡ 20-30%**
- ç¯©é¸æ“ä½œéŸ¿æ‡‰ï¼š**å¿« 2 å€**
- é¦–å±è¼‰å…¥ï¼š**æ¸›å°‘ 30-50KB**

---

#### ğŸ› ç·Šæ€¥ä¿®å¾©ï¼šå¾Œå°æ–°å¢/ç·¨è¼¯åŠŸèƒ½å¤±æ•ˆå•é¡Œ
- **å•é¡Œ**: å¾Œå°ç®¡ç†é é¢ï¼ˆå“ç‰Œã€åˆ†é¡ã€ç”¢å“ï¼‰æ–°å¢å’Œç·¨è¼¯æ™‚å‡ºç¾ 400 éŒ¯èª¤
- **ä¿®å¾©å…§å®¹** (`src/graphql/schema.ts`):
  1. Create Inputï¼šå°‡ `slug` æ”¹ç‚ºå¯é¸ï¼ˆ`String!` â†’ `String`ï¼‰
  2. Update Inputï¼šæ–°å¢ç¼ºå°‘çš„ `slug` æ¬„ä½
- **æ¸¬è©¦çµæœ**: âœ… æ–°å¢/ç·¨è¼¯åŠŸèƒ½å…¨éƒ¨æ¢å¾©æ­£å¸¸

#### ğŸ› ä¿®å¾© GraphQL èªè­‰ Context çµæ§‹ä¸åŒ¹é…å•é¡Œ
- **å•é¡Œ**: `/admin/users` é é¢ç„¡æ³•é¡¯ç¤ºç”¨æˆ¶åˆ—è¡¨ï¼Œæ‰€æœ‰éœ€è¦ç®¡ç†å“¡æ¬Šé™çš„ GraphQL æŸ¥è©¢è¿”å› "Access denied"
- **æ ¹æœ¬åŸå› **: GraphQL route è¿”å›çš„ context çµæ§‹èˆ‡ resolvers æœŸæœ›çš„ä¸åŒ¹é…
- **ä¿®å¾©å…§å®¹** (`app/api/graphql/route.ts:40-72`):
  - åŒæ™‚è¿”å›åµŒå¥—å’Œæ‰å¹³å…©ç¨®çµæ§‹ï¼Œå‘å¾Œå…¼å®¹æ‰€æœ‰ resolvers
  - æ–°å¢å¾ Cookie è®€å– token çš„æ”¯æŒ
  - å„ªå…ˆé †åºï¼šAuthorization header > Cookie
- **æ¸¬è©¦çµæœ**: âœ… ç”¨æˆ¶åˆ—è¡¨æŸ¥è©¢æˆåŠŸï¼Œç®¡ç†å“¡æ¬Šé™é©—è­‰æ­£å¸¸

#### âœ¨ æ–°å¢ Slug è‡ªå‹•ç”ŸæˆåŠŸèƒ½ + å‰ç«¯ä»‹é¢å„ªåŒ–
- **åŠŸèƒ½**: å“ç‰Œã€åˆ†é¡ã€ç”¢å“çš„ slug ç¾åœ¨æœƒè‡ªå‹•å¾åç¨±ç”Ÿæˆï¼Œå®Œå…¨ç„¡éœ€æ‰‹å‹•è¼¸å…¥
- **å„ªå‹¢**:
  - âœ… é™ä½ä½¿ç”¨è€…æ“ä½œé–€æª»ï¼ˆç®¡ç†å“¡ä¸éœ€æ‰‹å‹•è¼¸å…¥ slugï¼‰
  - âœ… è‡ªå‹•è™•ç†é‡è¤‡ slugï¼ˆè‡ªå‹•åŠ æ•¸å­—å¾Œç¶´ï¼Œå¦‚ `nike-2`ï¼‰
  - âœ… SEO å‹å–„çš„ URLï¼ˆè‡ªå‹•è½‰å°å¯«ã€ç©ºæ ¼è½‰æ©«ç·šã€ç§»é™¤ç‰¹æ®Šå­—ç¬¦ï¼‰
  - âœ… æ”¯æ´ä¸­æ–‡å­—ç¬¦ï¼ˆå¯ä¿ç•™ä¸­æ–‡æˆ–ä½¿ç”¨è‹±æ–‡å°ç…§è¡¨ï¼‰
- **å¾Œç«¯å¯¦ä½œ**: æ–°å¢ `src/lib/slugify.ts` å·¥å…·å‡½æ•¸åº«ï¼ˆ220+ è¡Œï¼‰
- **å‰ç«¯å„ªåŒ–**: å®Œå…¨ç§»é™¤ slug è¼¸å…¥æ¬„ä½ï¼Œåœ¨åç¨±æ¬„ä½ä¸‹æ–¹é¡¯ç¤ºè‡ªå‹•ç”Ÿæˆæç¤º

#### ğŸ—‘ï¸ ç§»é™¤å“ç‰Œå’Œåˆ†é¡çš„æè¿°æ¬„ä½
- **è®Šæ›´**: å¾ Brand å’Œ Category ç§»é™¤ `description` æ¬„ä½
- **åŸå› **: ç”¨æˆ¶åé¥‹ä¸éœ€è¦è©²æ¬„ä½ï¼Œç°¡åŒ–è³‡æ–™çµæ§‹
- **å½±éŸ¿ç¯„åœ**: è³‡æ–™åº« Schemaã€GraphQL Schemaã€å‰ç«¯é é¢å…¨éƒ¨åŒæ­¥æ›´æ–°

#### ğŸ”§ ä¿®å¾©å¾Œå°åˆ†é¡ç·¨è¼¯æ¬Šé™å•é¡Œ
- **å•é¡Œ**: ç·¨è¼¯åˆ†é¡æ™‚é¡¯ç¤ºã€Œæ¬Šé™ä¸è¶³ã€éŒ¯èª¤
- **æ ¹æœ¬åŸå› **: `productResolvers.ts` ä¸­çš„ GraphQLContext é¡å‹å®šç¾©èˆ‡å¯¦éš› context çµæ§‹ä¸åŒ¹é…
- **ä¿®å¾©å…§å®¹**: æ›´æ–° GraphQLContext æ¥å£å®šç¾©ï¼Œçµ±ä¸€ä½¿ç”¨æ‰å¹³çµæ§‹

#### ğŸ”§ ä¿®å¾©å¾Œå°é€€è²¨ç®¡ç†é é¢æ¬Šé™å•é¡Œ
- **å•é¡Œ**: GraphQL API è¿”å› "éœ€è¦ç®¡ç†å“¡æ¬Šé™" éŒ¯èª¤
- **ä¿®å¾©å…§å®¹**: å‰µå»º Context é¡å‹å®šç¾©ï¼Œä¿®å¾© GraphQL API çš„ context è¨­ç½®

#### ğŸ”§ ä¿®å¾©ç”¨æˆ¶ç®¡ç†é é¢ç·¨è¼¯åŠŸèƒ½
- **å•é¡Œ**: ç·¨è¼¯æœƒå“¡ç©åˆ†æ™‚å‡ºç¾éŒ¯èª¤ `Cannot assign to read only property 'membershipPoints'`
- **æ ¹æœ¬åŸå› **: ç›´æ¥ä¿®æ”¹å¾ GraphQL æŸ¥è©¢è¿”å›çš„å”¯è®€ç‰©ä»¶
- **ä¿®å¾©å…§å®¹**: æ–°å¢ç¨ç«‹çš„ `formData` stateï¼Œä½¿ç”¨å±•é–‹é‹ç®—ç¬¦å‰µå»ºæ–°ç‰©ä»¶

#### ğŸ—‘ï¸ å®Œå…¨ç§»é™¤ SKU ç³»çµ±
- å¾ Productã€ProductVariantã€OrderItem è³‡æ–™è¡¨ç§»é™¤ SKU æ¬„ä½
- å¾ GraphQL Schema ç§»é™¤æ‰€æœ‰ SKU å®šç¾©
- å¾å‰ç«¯æ–°å¢/ç·¨è¼¯é é¢ç§»é™¤ SKU è¼¸å…¥æ¬„ä½

#### âœ… æ–°å¢ç”¢å“åœ–ç‰‡ä¸Šå‚³åŠŸèƒ½
- æ”¯æ´ä¸Šå‚³åœ–ç‰‡åˆ°æœ¬åœ° `/public/uploads/products/` ç›®éŒ„
- æ–°å¢ `/api/upload` API ç«¯é»è™•ç†åœ–ç‰‡ä¸Šå‚³
- æ”¯æ´å¤šå¼µåœ–ç‰‡ï¼ˆæœ€å¤š 8 å¼µï¼‰
- æ”¯æ´æ‹–æ‹½æ’åºå’Œåˆªé™¤

#### âœ… ä¿®å¾©å¤–éƒ¨ä½”ä½åœ–ä¾è³´
- ç§»é™¤ `via.placeholder.com` ä¾è³´ï¼Œæ”¹ç”¨æœ¬åœ° SVG ä½”ä½åœ–

#### ğŸ”§ ä¿®å¾©å¾Œå°åˆ†é¡ç®¡ç†åŠŸèƒ½
- å¯¦ä½œå®Œæ•´çš„ Apollo Client é€£æ¥åˆ° GraphQL API
- æ·»åŠ  `createCategory`ã€`updateCategory`ã€`deleteCategory` mutations
- æ›¿æ› `alert()` ç‚º `react-hot-toast` æç¤º

#### ğŸ”§ ä¿®å¾©å“ç‰Œç®¡ç†é é¢åŠŸèƒ½
- å¾Œç«¯ï¼šæ·»åŠ å“ç‰Œç®¡ç†çš„ Resolvers
- å‰ç«¯ï¼šå®Œæ•´çš„ Apollo Client é€£æ¥åˆ° GraphQL API
- æ›¿æ› `alert()` ç‚º `react-hot-toast` æç¤º

#### âœ… GraphQL æ•´åˆï¼šç”¢å“åˆ—è¡¨é å®Œæ•´é€£æ¥ API
- ç§»é™¤æ‰€æœ‰ Mock æ•¸æ“šï¼Œæ”¹ç”¨çœŸå¯¦ GraphQL API
- å¯¦ä½œç”¢å“åˆªé™¤åŠŸèƒ½ï¼ˆå–®å€‹ + æ‰¹é‡ï¼‰
- ä¿®å¾©æœå°‹éæ¿¾é‚è¼¯

#### âœ… GraphQL æ•´åˆï¼šç”¢å“ç·¨è¼¯é é¢å®Œæ•´é‡æ§‹
- ç§»é™¤æ‰€æœ‰æ¨¡æ“¬æ•¸æ“šï¼Œæ”¹ç”¨çœŸå¯¦ GraphQL API
- æ–°å¢ `GET_PRODUCT_BY_ID` æŸ¥è©¢
- ä½¿ç”¨ `toast` æ›¿æ›åŸå§‹ `alert` æç¤º

---

### 2025-10-27

- âœ… å®Œæ•´ç¹é«”ä¸­æ–‡åŒ–ï¼ˆ80+ æª”æ¡ˆï¼Œå‰å¾Œå°æ‰€æœ‰æ–‡å­—ï¼‰
- âœ… æ–°å¢é€€è²¨ç³»çµ±ï¼ˆç”³è«‹ã€å¯©æ ¸ã€711 å¯„ä»¶ã€è³¼ç‰©é‡‘é€€æ¬¾ï¼‰
- âœ… å¤šå±¤æ¬Šé™ä¿è­·ï¼ˆä¼ºæœå™¨ç«¯ + å®¢æˆ¶ç«¯é›™é‡é©—è­‰ï¼‰
- âœ… LINE Login + OTP èªè­‰ç³»çµ±
- âœ… é›™è»Œèªè­‰ç³»çµ±ï¼ˆæ¶ˆè²»è€… LINE / ç®¡ç†å“¡å¿«é€Ÿç™»å…¥ï¼‰
- âœ… ç¤¾ç¾¤é€£çµç®¡ç†
- âœ… å®¢æœèŠå¤©ç³»çµ±

---

### 2025-10-20

- âœ… æ•ˆèƒ½å„ªåŒ–å®Œæˆï¼ˆéŸ¿æ‡‰é€Ÿåº¦æå‡ 5-20 å€ï¼‰
- âœ… Redis å¿«å–ç³»çµ±ä¸Šç·š
- âœ… GraphQL N+1 å•é¡Œä¿®å¾©
- âœ… è³‡æ–™åº«ç´¢å¼•å„ªåŒ–ï¼ˆ50+ å€‹ç´¢å¼•ï¼‰
- âœ… æ§‹å»ºå„ªåŒ–ï¼ˆé«”ç©æ¸›å°‘ 42%ï¼‰
- âœ… API é™æµï¼ˆ100 req/minï¼‰

</details>

---

## ğŸ¤ è²¢ç»æŒ‡å—

1. Fork å°ˆæ¡ˆ
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤è®Šæ›´ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. é–‹å•Ÿ Pull Request

---

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Š - è©³è¦‹ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ‘¥ ä½œè€…

- **é–‹ç™¼è€…**: Eric
- **Email**: [æ‚¨çš„Email]
- **GitHub**: [æ‚¨çš„GitHub]

---

## ğŸ™ è‡´è¬

- Next.js åœ˜éšŠ
- Prisma åœ˜éšŠ
- Tailwind CSS åœ˜éšŠ
- Apollo GraphQL åœ˜éšŠ

---

## ğŸ“‹ æ–‡æª”èªªæ˜

æœ¬ README.md æ˜¯æœ¬å°ˆæ¡ˆçš„**å”¯ä¸€ä¸»è¦æ–‡æª”**ï¼Œæ•´åˆäº†ï¼š
- å°ˆæ¡ˆæ¶æ§‹èªªæ˜
- é–‹ç™¼æŒ‡å—
- æ¸¬è©¦å ±å‘Š
- æ•ˆèƒ½å„ªåŒ–è¨˜éŒ„
- API æ–‡æª”
- æ•…éšœæ’é™¤æŒ‡å—

æ ¹æ“šå°ˆæ¡ˆè¦ç¯„ï¼Œä¸æ‡‰å‰µå»ºé¡å¤–çš„ .md æ–‡æª”ï¼Œæ‰€æœ‰æ›´æ–°éƒ½æ‡‰åŒæ­¥åˆ°æœ¬æ–‡æª”ã€‚

---

ğŸ’¡ **æç¤º**: é‡åˆ°å•é¡Œè«‹å…ˆæŸ¥çœ‹ã€Œæ•…éšœæ’é™¤ã€ç« ç¯€ï¼Œå†æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°å’Œçµ‚ç«¯æ©ŸéŒ¯èª¤è¨Šæ¯ã€‚
